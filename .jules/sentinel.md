## 2024-03-24 - Secure Tor Control Authentication
**Vulnerability:** The script used `echo -e` to construct the Tor Control authentication command. This was vulnerable to injection or protocol errors if the password contained special characters (especially double quotes or backslashes), as `echo -e` interprets escapes and the password was not properly escaped for the Tor protocol string syntax.
**Learning:** `echo -e` is unsafe for untrusted or arbitrary data. Constructing protocol messages with string concatenation requires careful escaping relative to the target protocol's syntax.
**Prevention:** Use `printf` to insert data into format strings to avoid shell interpretation. Explicitly escape data according to the target protocol (in this case, escaping `\` and `"` for Tor's quoted string format) before insertion.
