## 2025-01-11 - Tor Control Port Injection Prevention
**Vulnerability:** The script used `echo -e` to construct Tor Control Protocol commands, injecting the unescaped `AUTH_PASSWORD` variable directly into the string. A malicious or misconfigured password containing newlines and quotes could inject arbitrary commands (e.g., `SIGNAL SHUTDOWN`).
**Learning:** `echo -e` is risky for constructing protocol messages with user-controlled input because it interprets escapes in the input. Additionally, simply wrapping a variable in quotes within a string is insufficient if the target protocol uses quoted strings that require internal escaping of quotes and backslashes.
**Prevention:** Use `printf` for safer string formatting. Explicitly escape special characters (backslashes, double quotes, newlines, carriage returns) in variables before embedding them in protocol-specific quoted strings. For Tor Control Protocol, the escape sequence `\` -> `\\` must happen *before* other escapes to avoid double-escaping.
